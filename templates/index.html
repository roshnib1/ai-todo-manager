<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI To-Do Manager</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">

    <!-- Header -->
    <div class="header">
      <h1>📚 AI-Powered To-Do Manager</h1>
      <p class="subtitle">Manage your tasks smarter with AI suggestions</p>
    </div>

    <!-- Analytics Cards -->
    <div class="analytics">
      <div class="card">
        <div class="icon">✅</div>
        <div class="count" id="completedCount">{{ completed_count }}</div>
        <div class="label">Completed</div>
      </div>
      <div class="card">
        <div class="icon">🕒</div>
        <div class="count" id="pendingCount">{{ pending_count }}</div>
        <div class="label">Pending</div>
      </div>
      <div class="card">
        <div class="icon">💡</div>
        <div class="count" id="aiTasksCount">{{ ai_count }}</div>
        <div class="label">AI Suggestions</div>
      </div>
    </div>

    <!-- AI Recommendations -->
    <div class="ai-section">
      <h2>🧠 AI Task Suggestions</h2>
      <form action="/generate" method="GET" class="ai-form">
        <input type="text" name="interests" placeholder="Your interests..." />
        <button type="submit">Get AI Suggestions</button>
      </form>

      <div class="task-grid">
        {% for task in ai_tasks %}
          <div class="task-card">
            <div class="task-header">
              <span class="task-title">{{ task.task }}</span>
              <form action="/add_ai_task" method="POST" style="display:inline;">
                <input type="hidden" name="task_id" value="{{ task.id }}">
                <button type="submit">➕ Add</button>
              </form>
            </div>
            <p class="task-notes">{{ task.ai_reason }}</p>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- My Tasks -->
    <div class="todo-section">
      <h2>My Tasks</h2>

      <!-- Add New Task -->
      <form action="/add" method="POST" class="add-task-form">
        <input type="text" name="task" placeholder="New Task" required />
        <button type="submit">➕ Add Task</button>
      </form>

      <!-- Task List -->
      <div class="task-grid">
        {% for task in tasks %}
          <div class="task-card {% if task.status == 'Completed' %}completed{% endif %}">
            <div class="task-header">
              <span class="task-title">{{ task.task }}</span>
              <div class="task-actions">

                {% if task.status != 'Completed' %}
                  <form action="/complete/{{ task.id }}" method="POST" style="display:inline;">
                    <button type="submit">✅ Complete</button>
                  </form>
                {% else %}
                  <span style="color:green;">✔ Completed</span>
                {% endif %}

                <!-- Inline Edit -->
                <form action="/update/{{ task.id }}" method="POST" style="display:inline;">
                  <input type="text" name="task" value="{{ task.task }}" required />
                  <input type="text" name="notes" value="{{ task.notes }}" placeholder="Notes" />
                  <input type="number" name="progress" value="{{ task.progress }}" min="0" max="100" />
                  <button type="submit">✏️ Update</button>
                </form>

                <a href="/delete/{{ task.id }}">🗑️</a>
              </div>
            </div>

            {% if task.notes %}
              <p class="task-notes">{{ task.notes }}</p>
            {% endif %}

          </div>
        {% endfor %}
      </div>
    </div>

  </div>
</body>
</html>
